<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>–ö—Ä–∞—Å–∏–Ω–∞ 1</title>
    <style>
        body {
            direction: ltr;
            font-family: Arial, sans-serif;
            padding-left: 200px;
            padding-right: 200px;
            padding-top: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #999;
            padding: 5px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .negative {
            background-color: red;
            color: white;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-top: 20px;
            font-family: monospace;
        }
        .bt{
            margin: auto;
            width: 50%;
        }
        button {
            padding: 10px 20px;
            background-color: rgb(130, 224, 114);
            width: 100%;
            font-size: 20px;
            
        }
    </style>
</head>
<body>

    <h2>–¢–∞–±–ª–∏—Ü–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ö—Ä–∞—Å–∏–Ω–∞ 1</h2>

    
<textarea id="excelInput" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel" ></textarea><br>
<div class="bt">
<button onclick="parseExcelData()"> –∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
</div>
<table id="dataTable">
    <thead>
        <tr>
            <th>–ú–∞—Ç–µ—Ä–∏–∞–ª</th>
            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç</th>
            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω</th>
            <th>–†–∞–∑–Ω–∏—Ü–∞</th>
        </tr>
    </thead>
    <tbody>
        <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ° ÿßŸÑÿ≥ÿ∑Ÿàÿ± ÿØŸäŸÜÿßŸÖŸäŸÉŸäŸãÿß -->
    </tbody>
</table>

<script>
    const tableBody = document.querySelector("#dataTable tbody");
    const rowsCount = 173;

    // üîπ ŸÇÿßÿ¶ŸÖÿ© ÿ£ÿ≥ŸÖÿßÿ° ÿßŸÑŸÖŸàÿßÿØ
    const materialNames = [
  "3D —Å—Ç–∏–∫–µ—Ä –í–ï–°–ù–ê –≤ –ø–æ–¥–∞—Ä–æ–∫",
  "–ê–≤–æ–∫–∞–¥–æ —Å–≤–µ–∂–∏–π",
  "–ê–Ω–∞–Ω–∞—Å—ã –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑–∞–Ω—ã–µ",
  "–ë–∞—Ç–∞—Ç —Ñ—Ä–∏, –≥—Ä",
  "–ë–µ–Ω—Ç–æ –∫–æ—Ä–æ–±–∫–∞ 5 —Å–µ–∫—Ü.",
  "–ë–ª–∏–Ω—ã —Ç–∞–º–∞–≥–æ",
  "–ë–æ–±—ã –≠–¥–∞–º–∞–º–µ",
  "–í–∞—Å–∞–±–∏ –ø–æ—Ä—Ü–∏–æ–Ω–Ω–æ–µ 5–≥—Ä",
  "–í–∏–ª–∫–∞ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –≤ –∏–Ω–¥. —É–ø.",
  "–í–æ–¥–æ—Ä–æ—Å–ª–∏ –≤ –ø–ª–µ–Ω–∫–µ (–Ω–æ—Ä–∏ –¥–ª—è –æ–Ω–∏–≥–∏—Ä–∏)",
  "–í–æ–¥–æ—Ä–æ—Å–ª–∏ –ù–æ—Ä–∏",
  "–ì–∞–∑ –≤–æ–¥–∞ Vinut –≥—É–∞–≤–∞",
  "–ì–∞–∑.–í–æ–¥–∞",
  "–î–µ—Ä–∂–∞—Ç–µ–ª—å –¥–ª—è 2-—Ö —Å—Ç–∞–∫–∞–Ω–æ–≤",
  "–ñ–µ–ª–µ —à–∞—Ä–∏–∫–∏ –≤–∏–Ω–æ–≥—Ä–∞–¥",
  "–ñ–µ–ª–µ —à–∞—Ä–∏–∫–∏ –∫–æ–∫–æ—Å",
  "–ñ–µ–ª–µ —à–∞—Ä–∏–∫–∏ —Å–∞–∫—É—Ä–∞",
  "–ò–∫—Ä–∞ Macaro –æ—Ä–∞–Ω–∂–µ–≤–∞—è",
  "–ò–º–±–∏—Ä—å –ø–æ—Ä—Ü–∏–æ–Ω–Ω—ã–π 20–≥—Ä",
  "–ö–∞–±–∞—á–æ–∫ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–π",
  "–ö–∞–ø—É—Å—Ç–∞ –ø–µ–∫–∏–Ω—Å–∫–∞—è",
  "–ö–∞–ø—Ö–æ–ª–¥–µ—Ä",
  "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ø–æ-–¥–µ—Ä–µ–≤–µ–Ω—Å–∫–∏",
  "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å —Ñ—Ä–∏",
  "–ö–µ—Ç—á—É–ø Heinz, —à—Ç",
  "–ö–ª—É–±–Ω–∏–∫–∞ —Å—É–±–ª–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è",
  "–ö–æ–∫–æ—Å–æ–≤–æ–µ –∂–µ–ª–µ",
  "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–µ—Å–µ—Ä—Ç–∞ –∫—Ä—É–≥–ª—ã–π –ü–†–¢-85",
  "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–∞–ª–∞—Ç–∞ Buzzolls 750 –º–ª",
  "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —á–∏–∑–∫–µ–π–∫–∞",
  "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –°–ø–ö —á–µ—Ä–Ω—ã–π",
  "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–Ω—ã–π –∫—Ä—É–≥–ª—ã–π 530–º–ª",
  "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –≥—Ä–µ–π–ø—Ñ—Ä—É—Ç-–ª–∏—á–∏-—Ä–æ–∑–∞",
  "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –≥—Ä—É—à–∞",
  "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–æ–∫–æ—Å",
  "–ö–æ—Ä–Ω–∏—à–æ–Ω—ã –º–∞—Ä–∏–Ω–æ–≤–∞–Ω–Ω—ã–µ",
  "–ö–æ—Ä–æ–±–∫–∞ –±—É–º. –¥–ª—è —à—Ä–∏–º–ø —Ä–æ–ª–ª",
  "–ö–æ—Ä–æ–±–∫–∞ –¥–ª—è –í–æ–∫–∞ 450 –º–ª",
  "–ö–æ—Ä–æ–±–∫–∞ –ø–æ–¥ —Ä–æ–ª–ª—ã 155—Ö105—Ö40 Buzzolls",
  "–ö–æ—Ä–æ–±–∫–∞ –ø–æ–¥ —Ä–æ–ª–ª—ã 220—Ö145—Ö60 Buzzolls",
  "–ö–æ—Ä–æ–±–∫–∞ –ø–æ–¥ —Ä–æ–ª–ª—ã –ü—Ä–µ–º–∏—É–º Buzzolls 165*115*60",
  "–ö—Ä–∞–± –ü–§",
  "–ö—Ä–∞—Å–∏—Ç–µ–ª—å –ø–∏—â–µ–≤–æ–π –ñ–µ–º—á—É–≥",
  "–ö—Ä–µ–≤–µ—Ç–∫–∏ –¥–ª—è –í–æ–∫–∞ –¢–û–†–ü–ï–î–û",
  "–ö—Ä–µ–≤–µ—Ç–∫–∏ —Å/–æ—Ç–≤ –æ—á–∏—â–µ–Ω–Ω—ã–µ",
  "–ö—Ä—ã—à–∫–∞ –¥–ª—è —Å—Ç–∞–∫–∞–Ω–∞",
  "–ö—Ä—ã—à–∫–∞ –Ω–∞ —Å—Ç–∞–∫–∞–Ω –¥–ª—è –ª–∏–º–æ–Ω–∞–¥–∞",
  "–ö—É–Ω–∂—É—Ç –±–µ–ª—ã–π –∂–∞—Ä–µ–Ω–Ω—ã–π –ü–§",
  "–ö—É–Ω–∂—É—Ç —á–µ—Ä–Ω—ã–π",
  "–ö—É—Ä–∏–Ω–∞—è –∫–æ—Ç–ª–µ—Ç–∞ –¥–ª—è –í–æ–∫–∞ –ü–§",
  "–ö—É—Ä–∏—Ü–∞ –∫–æ–ø—á–µ–Ω–∞—è (—Ñ–∏–ª–µ)",
  "–õ–∞–π–º()",
  "–õ–∞–ø—à–∞ –ª–∞–≥–º–∞–Ω–Ω–∞—è",
  "–õ–µ–¥",
  "–õ–∏–º–æ–Ω",
  "–õ–æ–∂–∫–∞ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –≤ –∏–Ω–¥. —É–ø.",
  "–õ—É–∫–æ–≤—ã–µ –∫–æ–ª—å—Ü–∞",
  "–ú–∞–π–æ–Ω–µ–∑ –ü–µ—á–∞–≥–∏–Ω –≠–∫—Å—Ç—Ä–∞ 67%",
  "–ú–∞—Å–ª–æ –¥–ª—è —Ñ—Ä–∏—Ç—é—Ä–∞ –∏ –∂–∞—Ä–∫–∏",
  "–ú–∞—Å–ª–æ –∫—É–Ω–∂—É—Ç–Ω–æ–µ",
  "–ú–∞—Å–ª–æ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–æ–µ",
  "–ú–µ–ª–∞–Ω–∂",
  "–ú–∏–¥–∏–∏ –≤ —Ä–∞–∫–æ–≤–∏–Ω–µ (—à—Ç)",
  "–ú–∏–¥–∏–∏ –æ—Ç–≤–∞—Ä–Ω—ã–µ –ü–§",
  "–ú–∏–∫—Ä–æ–∑–µ–ª–µ–Ω—å –≥–æ—Ä–æ—Ö",
  "–ú–æ–ª–æ–∫–æ –¥–ª—è –∫–æ—Ñ–µ 3,2%",
  "–ú–æ–ª–æ–∫–æ –∫–æ–∫–æ—Å–æ–≤–æ–µ",
  "–ú–æ—Ä–∫–æ–≤—å",
  "–ú–æ—Ä–∫–æ–≤—å –ø–æ-–∫–æ—Ä–µ–π—Å–∫–∏",
  "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ",
  "–ú–æ—Ç–∏ –ö–ª—É–±–Ω–∏–∫–∞, —à—Ç",
  "–ú–æ—Ç–∏ –ú–∞–Ω–¥–∞—Ä–∏–Ω-—é–¥–∑—É, —à—Ç",
  "–ú–æ—Ç–∏ –®–æ–∫–æ–ª–∞–¥, —à—Ç",
  "–ù–∞–≥–≥–µ—Ç—Å—ã –∫—É—Ä–∏–Ω—ã–µ",
  "–û–±–µ—á–∞–π–∫–∞ –¥–ª—è –ë–µ–Ω—Ç–æ",
  "–û–±—Ä–µ–∑—å —Ç—É–Ω—Ü–∞ –ü–§",
  "–û–≥—É—Ä–µ—Ü –ü–§",
  "–û–≥—É—Ä–µ—Ü —Å–≤–µ–∂–∏–π",
  "–ü–∞–∫–µ—Ç –±—É–º–∞–∂–Ω—ã–π \"Buzzolls\"",
  "–ü–∞–∫–µ—Ç –∫—Ä–∞—Ñ—Ç –¥–ª—è –ë–µ–Ω—Ç–æ 320*200*320",
  "–ü–∞–∫–µ—Ç –∫—Ä–∞—Ñ—Ç–æ–≤—ã–π 140*60*250",
  "–ü–∞–ª–æ—á–∫–∏ –¥–ª—è –µ–¥—ã",
  "–ü–∞—Å—Ç–∞ –∞–Ω–∫–æ",
  "–ü–∞—Å—Ç–∞ –¢–æ–º –Ø–º",
  "–ü–µ—Ä–µ—Ü –±–æ–ª–≥–∞—Ä—Å–∫–∏–π",
  "–ü–µ—á–µ–Ω—å–µ –æ—Ä–µ–æ/—Ç—Ä–∏–æ",
  "–ü–æ–¥–ø–µ—Ä–≥–∞–º–µ–Ω—Ç 400*400 Buzzolls",
  "–ü–æ–º–∏–¥–æ—Ä—ã —Å–≤–µ–∂–∏–µ",
  "–ü–æ–º–∏–¥–æ—Ä—ã –ß–µ—Ä—Ä–∏",
  "–ü–æ—Ä–æ—à–æ–∫ –ú–∞—Ç—á–∞",
  "–ü–æ—Ä–æ—à–æ–∫ –¢–∞—Ä–æ",
  "–†–∞–∑–º–µ—à–∏–≤–∞—Ç–µ–ª—å",
  "–†–µ–¥–∏—Å",
  "–†–µ–ø—á–∞—Ç—ã–π –ª—É–∫",
  "–†–∏—Å",
  "–°–∞–ª–∞—Ç –ê–π—Å–±–µ—Ä–≥",
  "–°–∞–ª–∞—Ç –∏–∑ –≤–æ–¥–æ—Ä–æ—Å–ª–∏ —á—É–∫–∞",
  "–°–∞–ª–∞—Ç –º–∏–Ω–∏ —à–ø–∏–Ω–∞—Ç",
  "–°–∞—Ö–∞—Ä",
  "–°–∞—Ö–∞—Ä —Ñ–∞—Å–æ–≤–∞–Ω–Ω—ã–π",
  "–°–≥—É—â–µ–Ω–Ω–æ–µ –º–æ–ª–æ–∫–æ",
  "–°–∏—Ä–æ–ø –≥—É–∞–≤–∞",
  "–°–∏—Ä–æ–ø –∂–∞—Å–º–∏–Ω",
  "–°–∏—Ä–æ–ø —Ñ–∞–ª–µ—Ä–Ω—É–º",
  "–°–∏—Ä–æ–ø —Ñ–µ–π—Ö–æ–∞",
  "–°–∏—Ä–æ–ø —é–¥–∑—É",
  "–°–ª–∏–≤–æ—á–Ω–æ–µ –º–∞—Å–ª–æ 82,5%",
  "–°–º–µ—Å—å –∞—Ä–±—É–∑",
  "–°–º–µ—Å—å –≤–∏–Ω–æ–≥—Ä–∞–¥",
  "–°–º–µ—Å—å —Ç–µ–º–ø—É—Ä–Ω–∞—è Nihao",
  "–°–º–µ—Å—å –®–∏—á–∏–º–∏ –ü–§",
  "–°–æ–µ–≤—ã–π —Å–æ—É—Å –ø–æ—Ä—Ü–∏–æ–Ω–Ω—ã–π 50–º–ª",
  "–°–æ—É—Å –±—É—Ä–≥–µ—Ä Heinz, –≤–µ—Å",
  "–°–æ—É—Å –¥/ —É–≥—Ä—è –£–Ω–∞–≥–∏",
  "–°–æ—É—Å –¥–ª—è Wok –ü–§",
  "–°–æ—É—Å –ö–∞—Ä—Ä–∏, —à—Ç",
  "–°–æ—É—Å –ö–∏–º–ø–∞–± –ü–§",
  "–°–æ—É—Å –∫—É–Ω–∂—É—Ç–Ω—ã–π(–æ—Ä–µ—Ö–æ–≤—ã–π)",
  "–°–æ—É—Å –ú–∞–Ω–≥–æ –ß–∏–ª–∏",
  "–°–æ—É—Å –ú–∏—Ü—É–∫–∞–Ω –ü–§, —à—Ç",
  "–°–æ—É—Å —Å–æ–µ–≤—ã–π",
  "–°–æ—É—Å –°–ø–∞–π—Å–∏ –ü–§",
  "–°–æ—É—Å —Å—É–ª—É–≥—É–Ω–∏ –ü–§ New",
  "–°–æ—É—Å —Å—ã—Ä–Ω—ã–π Heinz, —à—Ç",
  "–°–æ—É—Å –¶–µ–∑–∞—Ä—å Heinz",
  "–°–æ—É—Å —á–∏–ª–∏ —Å–ª–∞–¥. –¥/–∫—É—Ä–∏—Ü—ã",
  "–°–æ—É—Å –Ø–∫–∏ –ü–§",
  "–°–æ—É—Å–Ω–∏–∫ 30 –º–ª",
  "–°–æ—É—Å–Ω–∏–∫ 50 –º–ª",
  "–°–ø–∏—Ä—É–ª–∏–Ω–∞ —Å–∏–Ω—è—è",
  "–°—Ç–∞–∫–∞–Ω 330 –º–ª Buzzolls",
  "–°—Ç–∞–∫–∞–Ω 500 –º–ª –º–∞—Ç–æ–≤—ã–π+–∫—Ä—ã—à–∫–∞ –†–†",
  "–°—Ç–∏–∫–µ—Ä \"–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞\"",
  "–°—Ç—Ä—É–∂–∫–∞ —Ç—É–Ω—Ü–∞",
  "–°—É—Ö–∞—Ä–∏ –ø–∞–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ",
  "–°—É—Ö–∞—Ä–∏–∫–∏ –ø—à–µ–Ω–∏—á–Ω—ã–µ 10–≥—Ä —à—Ç",
  "–°—ã—Ä –ø–∞—Ä–º–µ–∑–∞–Ω",
  "–°—ã—Ä –°—É–ª—É–≥—É–Ω–∏ —Ç–µ—Ä—Ç—ã–π –ü–§",
  "–°—ã—Ä –¢–≤–æ—Ä–æ–∂–Ω—ã–π",
  "–°—ã—Ä –ß–∏–∑–±—É—Ä–≥–µ—Ä",
  "–¢–∞–∫—É–∞–Ω —Ä–µ–¥—å–∫–∞",
  "–¢–∞–ø–∏–æ–∫–∞ –∫–æ—Ä–∏—á–Ω–µ–≤–∞—è",
  "–¢–∞—Ä—Ç–∞–ª–µ—Ç–∫–∞ –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ-–æ—Ä–µ—Ö–æ–≤–∞—è, —à—Ç",
  "–¢–∞—Ä—Ç–∞–ª–µ—Ç–∫–∞ –ú–∞–ª–∏–Ω–æ–≤–∞—è, —à—Ç",
  "–¢–æ—Ä—Ç –ú–æ–ª–æ—á–Ω–∞—è –¥–µ–≤–æ—á–∫–∞, —à—Ç",
  "–¢–æ—Ä—Ç–∏–ª—å—è –ø—à–µ–Ω–∏—á–Ω–∞—è",
  "–¢—Ä—É–±–æ—á–∫–∞ –¥/–∫–æ–∫—Ç–µ–π–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è 12 —Ö 240–º–º",
  "–¢—Ä—É–±–æ—á–∫–∞ —á–µ—Ä–Ω–∞—è",
  "–£–≥–æ—Ä—å –¥–ª—è –æ–Ω–∏–≥–∏—Ä–∏ –ü–§",
  "–£–≥–æ—Ä—å –æ–±—Ä–µ–∑—å –ü–§",
  "–£–≥–æ—Ä—å —Ñ–∏–ª–µ –ü–§",
  "–£–∫—Å—É—Å —è–±–ª–æ—á–Ω—ã–π",
  "–£–ø–∞–∫–æ–≤–∫–∞ –ø–æ–¥ —Ñ—Ä–∏ Buzzolls",
  "–£–ø–∞–∫–æ–≤–∫–∞ –ü–†–¢-85 –¥–ª—è –¥–µ—Å–µ—Ä—Ç–∞",
  "–§–∏–ª–µ —Ç—É–Ω—Ü–∞ –ü–§",
  "–§–∏—à —Å–æ—É—Å",
  "–§–æ—Ä–µ–ª—å –æ–±—Ä–µ–∑—å –¥–ª—è –ü–æ–∫–µ –ü–§",
  "–§–æ—Ä–µ–ª—å –æ–±—Ä–µ–∑—å –ü–§",
  "–§–æ—Ä–µ–ª—å —Ñ–∏–ª–µ –ü–§",
  "–§–æ—Ä–µ–ª—å —á–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –ü–§",
  "–¶–≤–µ—Ç—ã —Å—É—à–µ–Ω—ã–µ",
  "–ß–∞–π –∑–µ–ª–µ–Ω—ã–π, –≥—Ä",
  "–ß–∞–π —á–µ—Ä–Ω—ã–π, –≥—Ä",
  "–ß–µ—Å–Ω–æ–∫ —Ä–∞–∑–≤–µ—Å–Ω–æ–π",
  "–ß–∏–∑–∫–µ–π–∫ –ö–ª—É–±–Ω–∏—á–Ω—ã–π",
  "–ß–∏–∑–∫–µ–π–∫ –ú–∞–ª–∏–Ω–∞, —à—Ç",
  "–ß–∏–∑–∫–µ–π–∫ –®–æ–∫–æ–ª–∞–¥–Ω—ã–π",
  "–®–∞–º–ø–∏–Ω—å–æ–Ω—ã",
  "–®–∞—Ä–∏–∫–∏ —Ä–∏—Å–æ–≤—ã–µ –¢–æ–º —è–º",
];

    // üîπ ÿßŸÑŸÇŸäŸÖ ÿßŸÑÿ´ÿßÿ®ÿ™ÿ© ŸÑŸÑŸÉŸÖŸäÿ© ÿßŸÑŸÖÿÆÿ∑ÿ∑ÿ©
    const fixedPlanValues = [
  20, 1000, 1000, 2500, 150, 6000, 1000, 5000, 200,
  400, 2000, 2000, 5000, 50, 2000, 2000, 2000, 5000, 5000,
  1000, 2000, 100, 5000, 5000, 50, 30, 2000, 200, 200,
  200, 200, 200, 1000, 1000, 1000, 2000, 200, 500, 10000,
  10000, 500, 5000, 20, 6000, 10000, 1000, 500, 4000, 3000,
  20, 30000, 500, 3000, 100000, 1000, 2000, 6000, 2000, 50000,
  1000, 10000, 900, 175, 5000, 1000, 6000, 3000, 1000, 2000,
  3000, 20, 20, 20, 5000, 100, 5000, 5000, 10000, 5000,
  1000, 2000, 5000, 400, 2000, 2000, 100, 1000, 2000, 500,
  1000, 1000, 250, 500, 1000, 150000, 2000, 1000, 600, 1000,
  200, 2000, 1000, 1000, 1000, 1000, 1000, 400, 1000,
  1000, 10000, 1000, 5000, 2000, 15000, 2000, 30, 1000,
  2000, 500, 50, 2000, 2000, 10000, 50, 4000, 2000,
  10000, 200, 200, 100, 500, 500, 2000, 1000, 10000, 100,
  2000, 2000, 50000, 2000, 2000, 2000, 20, 20, 24, 100,
  1000, 500, 500, 4000, 1000, 500, 1000, 100, 1000, 500,
  500, 5000, 5000, 5000, 1000, 50, 50, 500, 12, 12,
  12, 500, 1000
];

    // üîÅ ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©/ÿßŸÑÿ¥ÿ±ŸÇŸäÿ© ÿ•ŸÑŸâ ÿ£ÿ±ŸÇÿßŸÖ ÿ•ŸÜŸÉŸÑŸäÿ≤Ÿäÿ© Ÿàÿ≠ÿ∞ŸÅ ÿßŸÑŸÖÿ≥ÿßŸÅÿßÿ™
    function convertArabicToEnglishNumbers(str) {
        const arabicMap = 'Ÿ†Ÿ°Ÿ¢Ÿ£Ÿ§Ÿ•Ÿ¶ŸßŸ®Ÿ©'.split('');
        const persianMap = '€∞€±€≤€≥€¥€µ€∂€∑€∏€π'.split('');

        return str
            .replace(/\s+/g, '') // ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖÿ≥ÿßŸÅÿßÿ™
            .replace(/[Ÿ†-Ÿ©]/g, d => arabicMap.indexOf(d)) // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
            .replace(/[€∞-€π]/g, d => persianMap.indexOf(d)); // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑŸÅÿßÿ±ÿ≥Ÿäÿ©
    }

    // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ¨ÿØŸàŸÑ Ÿàÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
    for (let i = 0; i < rowsCount; i++) {
        const row = document.createElement("tr");

        // üî∏ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿßÿØÿ©
        const materialIndex = i % materialNames.length;
        const materialCell = document.createElement("td");
        materialCell.textContent = materialNames[materialIndex];
        materialCell.contentEditable = false;

        // üî∏ ŸÉŸÖŸäÿ© ŸÅÿπŸÑŸäÿ©
        const factCell = document.createElement("td");
        factCell.contentEditable = true;

        // üî∏ ŸÉŸÖŸäÿ© ŸÖÿÆÿ∑ÿ∑ÿ©
        const planCell = document.createElement("td");
        planCell.contentEditable = true;

        const planIndex = i % fixedPlanValues.length;
        planCell.textContent = fixedPlanValues[planIndex];

        // üî∏ ÿßŸÑŸÅÿ±ŸÇ
        const diffCell = document.createElement("td");
        diffCell.textContent = "";

        row.appendChild(materialCell);
        row.appendChild(factCell);
        row.appendChild(planCell);
        row.appendChild(diffCell);

        tableBody.appendChild(row);
    }

    function parseExcelData() {
        const input = document.getElementById("excelInput").value.trim();
        const lines = input.split(/\r?\n/);
        const data = lines.map(line => line.split("\t"));

        const rows = tableBody.querySelectorAll("tr");

        rows.forEach(row => {
            const cells = row.querySelectorAll("td");
            const materialName = cells[0].textContent.trim();

            const matched = data.find(([name]) => name.trim() === materialName);

            if (matched) {
                let factValue = matched[1];
                if (factValue !== undefined) {
                    // ‚ö†Ô∏è ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑÿ¥ÿ±ŸÇŸäÿ© ŸàÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                    factValue = convertArabicToEnglishNumbers(factValue);

                    // ‚ö†Ô∏è ÿ≠ÿ∞ŸÅ ÿßŸÑŸÅÿßÿµŸÑÿ© ÿßŸÑÿπÿ¥ÿ±Ÿäÿ© ŸàŸÖÿß ÿ®ÿπÿØŸáÿß
                    factValue = factValue.split(',')[0];

                    // ‚ö†Ô∏è ÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿ¥Ÿäÿ° ÿ∫Ÿäÿ± ÿ±ŸÇŸÖŸä
                    const numericValue = parseInt(factValue.replace(/[^0-9]/g, ''), 10);

                    if (!isNaN(numericValue)) {
                        cells[1].textContent = numericValue;
                        updateDifference(cells[2], cells[1], cells[3]);
                    }
                }
            }
        });
    }

    function updateDifference(planCell, factCell, diffCell) {
        let planText = convertArabicToEnglishNumbers(planCell.textContent);
        let factText = convertArabicToEnglishNumbers(factCell.textContent);

        planText = planText.replace(/[^0-9]/g, '');
        factText = factText.replace(/[^0-9]/g, '');

        const plan = parseInt(planText, 10) || 0;
        const fact = parseInt(factText, 10) || 0;

        const diff = plan > fact;
        diffCell.textContent = diff;

        if (diff > 0) {
            diffCell.classList.add("negative");
        } else {
            diffCell.classList.remove("negative");
        }
    }

    tableBody.addEventListener("input", function(e) {
        if (e.target.tagName === "TD") {
            const row = e.target.parentElement;
            const cells = row.querySelectorAll("td");
            if (cells[2] && cells[1] && cells[3]) {
                updateDifference(cells[2], cells[1], cells[3]);
            }
        }
    });
</script>

</body>
</html>
